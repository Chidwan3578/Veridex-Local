generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id        String            @id @default(uuid())
  name      String
  email     String            @unique
  password  String
  role      String            // "candidate" | "recruiter"
  image     String?
  createdAt DateTime          @default(now())
  profile   CandidateProfile?
  jobs      Job[]
}

model CandidateProfile {
  id               String   @id @default(uuid())
  user             User     @relation(fields: [userId], references: [id])
  userId           String   @unique
  githubUsername   String?
  cgpa             Float
  overallScore     Float
  riskScore        String
  dataCompleteness Int
  lastActiveDate   DateTime
  skills           Skill[]
}

model Skill {
  id                String         @id @default(uuid())
  candidate         CandidateProfile @relation(fields: [candidateId], references: [id])
  candidateId       String
  name              String
  score             Float
  complexityScore   Float
  consistencyScore   Float
  collaborationScore Float
  recencyScore      Float
  impactScore       Float
  certificationBonus Float
  history           SkillHistory[]
}

model SkillHistory {
  id      String @id @default(uuid())
  skill   Skill  @relation(fields: [skillId], references: [id])
  skillId String
  month   String
  score   Float
}

model Job {
  id                  String   @id @default(uuid())
  recruiter           User     @relation(fields: [recruiterId], references: [id])
  recruiterId         String
  title               String
  description         String
  backendWeight       Float
  consistencyWeight   Float
  collaborationWeight Float
  recencyWeight       Float
  impactWeight        Float
  cgpaWeight          Float
  minThreshold        Float
  cgpaThreshold       Float?
  cgpaCondition       String?  // "above" | "below"
  createdAt           DateTime @default(now())
  matches             MatchResult[]
}

model MatchResult {
  id          String @id @default(uuid())
  job         Job    @relation(fields: [jobId], references: [id])
  jobId       String
  candidateId String
  fitScore    Float
  riskLevel   String
  gapSummary  String
}
